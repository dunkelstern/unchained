# Configuration

Unchained configuration has to be a class that implements the `UnchainedConfig` protocol.

For most settings a default implementation is provided as a protocol extension but there are at least 4 things that have to be overridden by your implementation:

- `serverName`
- `externalServerURL`
- `middleware`
- `routes`

If you look extremely closely `middleware` and `routes` have an empty default implementation but of what value would a web application be that doesn't do anything?

So let's explain what settings there are and what they do:

## `listenAdress` the IP interface to listen on

This describes to what IP address the server should bind. The default implementation binds to `.Wildcard` which simply means all IP addresses of the machine on IPv4 and IPv6 interfaces.

You may set this to any valid IP address of the machine it is running on.
The `IPAddress` class has a handy `init(fromString:)` initializer where you can set a string representation and have it parsed for you automatically.

To set this value you'll need to `import UnchainedIPAddress`.

## `listenPort` the port to listen on

This is just the port the server should bind to, it defaults to `8000`. Be aware that using ports below 1024 needs root privileges, Unchained is currently not able to drop privileges so please be aware that such a setup is currently unsupported.

If you want to run on a privileged port setup a reverse proxy with nginx or varnish.

## `serverName` the hostname of the server

As some virtual server environments have host names that don't mirror their external routed domains the server has to be supplied with a hostname that it should react to (direct calls via IP address will always work, even with a wrong hostname set).

Set this to `localhost` for local testing purposes (or to your `.local` domainname if you're on a Mac)

## `externalServerURL` URL to the base of the web application

This is usually just `http://<serverName>:<port>` if you're directly accessing the Unchained webserver. If you want to use TLS you'll have to insert a TLS terminator as a reverse proxy before Unchained and because Unchained does not know that a TLS terminator is used it is not aware that the URL starts with `https` in that case. So supply the externally visible URL here.

## `logfilePath` (writeable) path to the logfile

If you want to write a logfile, setup a path here, by default this is `nil` which means the logs will be written to `stdout`.

## `templateDirectory` path to templates

If you want to use the `TemplateResponse` the templating engine needs to know where the template files are on disk. This defaults to `<currentWorkingDirectory>/templates`.

## `staticFilesDirectory` path to static resources

All user visible web application need some static resources like images and css code that may be served from within Unchained. There are two possiblities to server static content, either you configure a reverse proxy like _nginx_ to serve the static content and just don't handle anything within Unchained or you set up a static file route in Unchained and set this to the directory to serve the files from. Defaults to `<currentWorkingDirectory>/static`.

## `mediaFilesDirectory` directory for generated and user uploaded files

Principally the same as the `staticFilesDirectory` but for files that will be generated by the web application or uploaded by users. Defaults to `<currentWorkingDirectory>/media`.

## `temporaryDirectory` temp files directory

This directory is used for caching large HTTP requests (like uploads) and some temporary files. It may be deleted on each restart of Unchained. Defaults to `/tmp`

## `middleware` list of installed middleware

This is just an array of `Middleware` instances that will be called for each request in the given order. The default is empty but the absolute minimum should be:

- `SessionMiddleware(store: InMemorySessionStore())`
- `CSRFMiddleware()`

If you want to support browser forms add at least the following after `SessionMiddleware`:

- `URLEncodedPostMiddleware()`
- `MultipartPostMiddleware()`

See [5. Middleware](middleware.html) for further information.

## `routes` URL routing

This maps URLs to Response Handlers it is a simple array of `Route` instances.
See [4. Routing](routing.html) for further information about routes.
